<div class="menu-container">
  <!-- Header com Stats -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <span class="title-icon">ğŸ½ï¸</span>
        CardÃ¡pio
      </h1>
      <p class="page-subtitle">Gerencie todos os pratos do seu restaurante</p>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon total">ğŸ“Š</div>
        <div class="stat-content">
          <span class="stat-number">{{totalDishes}}</span>
          <span class="stat-label">Total de Pratos</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon available">âœ…</div>
        <div class="stat-content">
          <span class="stat-number">{{availableDishes}}</span>
          <span class="stat-label">DisponÃ­veis</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon vegan">ğŸŒ±</div>
        <div class="stat-content">
          <span class="stat-number">{{veganDishes}}</span>
          <span class="stat-label">Veganos</span>
        </div>
      </div>

      <div class="stat-card add-new" (click)="openModal()">
        <div class="stat-icon new">â•</div>
        <div class="stat-content">
          <span class="stat-label">Novo Prato</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filters-grid">
      <!-- Busca -->
      <div class="filter-group">
        <label class="filter-label">ğŸ” Buscar</label>
        <input
          type="text"
          class="filter-input"
          placeholder="Nome ou descriÃ§Ã£o..."
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
        >
      </div>

      <!-- Filtro por Categoria -->
      <div class="filter-group">
        <label class="filter-label">ğŸ·ï¸ Categoria</label>
        <select
          class="filter-select"
          [(ngModel)]="filterCategory"
          (change)="onFilterChange()"
        >
          <option value="">Todas</option>
          <option *ngFor="let category of categories" [value]="category">{{category}}</option>
        </select>
      </div>

      <!-- Filtro Vegano -->
      <div class="filter-group">
        <label class="filter-label">ğŸŒ± Vegano</label>
        <select
          class="filter-select"
          [(ngModel)]="filterVegan"
          (change)="onFilterChange()"
        >
          <option value="">Todos</option>
          <option value="vegan">Apenas Veganos</option>
          <option value="non-vegan">NÃ£o Veganos</option>
        </select>
      </div>

      <!-- Filtro Disponibilidade -->
      <div class="filter-group">
        <label class="filter-label">ğŸ“‹ Status</label>
        <select
          class="filter-select"
          [(ngModel)]="filterAvailable"
          (change)="onFilterChange()"
        >
          <option value="">Todos</option>
          <option value="available">DisponÃ­veis</option>
          <option value="unavailable">IndisponÃ­veis</option>
        </select>
      </div>

      <!-- Limpar Filtros -->
      <div class="filter-group">
        <button class="clear-filters-btn" (click)="clearFilters()">
          ğŸ—‘ï¸ Limpar Filtros
        </button>
      </div>
    </div>
  </div>

  <!-- Lista de Pratos -->
  <div class="dishes-grid">
    <div
      *ngFor="let dish of filteredDishes; trackBy: trackByDishId"
      class="dish-card"
      [class.unavailable]="!dish.isAvailable"
    >
      <!-- Imagem do Prato -->
      <div class="dish-image">
        <img [src]="dish.image" [alt]="dish.name" />
        <div class="dish-badges">
          <span *ngIf="dish.isVegan" class="badge vegan">ğŸŒ± Vegano</span>
          <span *ngIf="!dish.isAvailable" class="badge unavailable">âŒ IndisponÃ­vel</span>
        </div>
        <div class="dish-actions-overlay">
          <button class="action-btn edit" (click)="openModal(dish)" title="Editar">
            âœï¸
          </button>
          <button
            class="action-btn toggle"
            (click)="toggleAvailability(dish)"
            [title]="dish.isAvailable ? 'Marcar como indisponÃ­vel' : 'Marcar como disponÃ­vel'"
          >
            {{dish.isAvailable ? 'ğŸš«' : 'âœ…'}}
          </button>
          <button class="action-btn delete" (click)="deleteDish(dish)" title="Excluir">
            ğŸ—‘ï¸
          </button>
        </div>
      </div>

      <!-- InformaÃ§Ãµes do Prato -->
      <div class="dish-info">
        <div class="dish-header">
          <h3 class="dish-name">{{dish.name}}</h3>
          <span class="dish-category">{{dish.category}}</span>
        </div>

        <p class="dish-description">{{dish.description}}</p>

        <div class="dish-details">
          <div class="detail-item">
            <span class="detail-icon">ğŸ’°</span>
            <span class="detail-value">R$ {{dish.price | number:'1.2-2'}}</span>
          </div>

          <div class="detail-item">
            <span class="detail-icon">â±ï¸</span>
            <span class="detail-value">{{dish.preparationTime}}min</span>
          </div>
        </div>

        <div class="ingredients-section" *ngIf="dish.ingredients.length > 0">
          <span class="ingredients-label">ğŸ§„ Ingredientes:</span>
          <div class="ingredients-list">
            <span
              *ngFor="let ingredient of dish.ingredients; let last = last"
              class="ingredient"
            >
              {{ingredient}}<span *ngIf="!last">, </span>
            </span>
          </div>
        </div>

        <div class="dish-meta">
          <span class="meta-item">Criado: {{dish.createdAt}}</span>
          <span class="meta-item">Atualizado: {{dish.updatedAt}}</span>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="filteredDishes.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ½ï¸</div>
      <h3 class="empty-title">Nenhum prato encontrado</h3>
      <p class="empty-message">Ajuste os filtros ou cadastre novos pratos</p>
      <button class="add-dish-btn" (click)="openModal()">
        â• Adicionar Primeiro Prato
      </button>
    </div>
  </div>

  <!-- Modal para Criar/Editar Prato -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{isEditing ? 'Editar Prato' : 'Novo Prato'}}</h2>
        <button class="close-btn" (click)="closeModal()">âœ•</button>
      </div>

      <form class="dish-form" (ngSubmit)="saveDish()">
        <div class="form-row">
          <div class="form-group">
            <label>ğŸ“ Nome do Prato</label>
            <input
              type="text"
              [(ngModel)]="currentDish.name"
              name="name"
              placeholder="Ex: Risotto de Cogumelos"
              required
            >
          </div>

          <div class="form-group">
            <label>ğŸ·ï¸ Categoria</label>
            <select [(ngModel)]="currentDish.category" name="category" required>
              <option value="">Selecione uma categoria</option>
              <option *ngFor="let category of categories" [value]="category">{{category}}</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>ğŸ“‹ DescriÃ§Ã£o</label>
          <textarea
            [(ngModel)]="currentDish.description"
            name="description"
            placeholder="Descreva o prato de forma apetitosa..."
            rows="3"
            required
          ></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ’° PreÃ§o (R$)</label>
            <input
              type="number"
              [(ngModel)]="currentDish.price"
              name="price"
              step="0.01"
              min="0"
              placeholder="0.00"
              required
            >
          </div>

          <div class="form-group">
            <label>â±ï¸ Tempo de Preparo (min)</label>
            <input
              type="number"
              [(ngModel)]="currentDish.preparationTime"
              name="preparationTime"
              min="0"
              placeholder="20"
              required
            >
          </div>
        </div>

        <div class="form-group">
          <label>ğŸ–¼ï¸ URL da Imagem</label>
          <input
            type="url"
            [(ngModel)]="currentDish.image"
            name="image"
            placeholder="https://example.com/imagem.jpg"
            required
          >
          <div class="image-preview" *ngIf="currentDish.image">
            <img [src]="currentDish.image" [alt]="currentDish.name" />
          </div>
        </div>

        <div class="form-group">
          <label>ğŸ§„ Ingredientes</label>
          <div class="ingredients-input">
            <div
              *ngFor="let ingredient of currentDish.ingredients; let i = index"
              class="ingredient-row"
            >
              <input
                type="text"
                [(ngModel)]="currentDish.ingredients[i]"
                [name]="'ingredient_' + i"
                placeholder="Ex: Arroz arbÃ³reo"
              >
              <button type="button" class="remove-ingredient" (click)="removeIngredient(i)">
                âŒ
              </button>
            </div>
            <button type="button" class="add-ingredient" (click)="addIngredient()">
              â• Adicionar Ingrediente
            </button>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input
                type="checkbox"
                [(ngModel)]="currentDish.isVegan"
                name="isVegan"
              >
              <span class="checkmark">ğŸŒ± Prato Vegano</span>
            </label>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input
                type="checkbox"
                [(ngModel)]="currentDish.isAvailable"
                name="isAvailable"
              >
              <span class="checkmark">âœ… DisponÃ­vel no CardÃ¡pio</span>
            </label>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="cancel-btn" (click)="closeModal()">
            Cancelar
          </button>
          <button type="submit" class="save-btn">
            {{isEditing ? 'Atualizar Prato' : 'Criar Prato'}}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
